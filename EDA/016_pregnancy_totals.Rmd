---
title: "Pregnancy Totals"
author: "Joshua Born"
output:
  html_document:
    code_folding: show
    toc: true
    toc_depth: 5
---

```{r setup, include=FALSE}
library(data.table)
library(here)
library(knitr)
```


## Live Births

Rather than using [CDC WONDER](https://wonder.cdc.gov/) or the [public use microdata files for births](https://www.cdc.gov/nchs/data_access/vitalstatsonline.htm), [this visualization](https://www.cdc.gov/nchs/data-visualization/natality-trends/) had the total live birth counts from 1909 to 2020 downloadable as a CSV. Once I get into subdomains, I will have to look for other ways to get counts, either via the microdata or be going through tables in published NCHS reports.

```{r}
vital_births <- fread(here('data/NCHS_-_Births_and_General_Fertility_Rates__United_States.csv'))
kable(vital_births)
```

## Induced Abortions

```{r}
guttmacher_pregnancies <- fread(here('data/guttmacher/NationalAndStatePregnancy_PublicUse.csv'))
national_guttmacher_totals <- guttmacher_pregnancies[
  state == 'US', .(
  Year = year,
  guttmacher_births = birthstotal,
  guttmacher_abortions = abortionstotal
)]

vital_births[Year > 1972, .(
  Year,
  vital_births = as.integer(gsub(',', '', `Birth Number`))
)][
  national_guttmacher_totals,
  on = 'Year'
][
  , all(vital_births == guttmacher_births)
]
```

The Guttmacher Institute's birth totals match the NVSS's.

```{r}
guttmacher_pregnancies[state == 'US', notes]

names(guttmacher_pregnancies)
```

There is no marker of which national abortion totals are the result of the Guttmacher Abortion Provider Census (APC) and which are interpolated.

```{r}
guttmacher_pregnancies[ ,
  abortions_interpolated :=  year %in% c(
      1983, 1986, 1989, 1990, 1993, 1994, 1997, 1998, 2001, 2002, 2003, 2006, 2009, 2012, 2015
  )
]

guttmacher_pregnancies[
  state == 'US' & !abortions_interpolated,
  .(
    Year = year,
    Abortions = abortionstotal
  )
][
  vital_births[,
    .(
      Year,
      Births = as.integer(gsub(',', '', `Birth Number`))
    )
  ],
  on = 'Year'
] |> kable()
```


## Fetal Deaths (of 20 Weeks Gestational Age or Above)


